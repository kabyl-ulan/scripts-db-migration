import{t as _,bT as M,r as d,bU as q,bV as R,j as s,dW as I,e as E,dX as P,d0 as z,d2 as v,u as U,dE as Z,d1 as K,B as X}from"./index.dc8861ba.js";import{E as G,b as H}from"./api.a723d610.js";import{T as J,S as Q}from"./Table.fb1d6459.js";import{T as N,E as Y}from"./index.7d0c3fe5.js";import{m as f}from"./index.00bf443f.js";import{F as C}from"./index.183fa59f.js";import"./useForm.40722572.js";import"./index.2ee5d23d.js";import"./EllipsisOutlined.5194278a.js";import"./index.3d0341d4.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const x={getDirectionsByFaculty:u=>`/direction/faculty/${u}`,addDirection:()=>"/direction",updateDirection:u=>`/direction/${u}`,deleteDirection:u=>`/direction/${u}`};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const u4=async u=>{var e;try{return await _.get(x.getDirectionsByFaculty(u))}catch(i){return(e=i==null?void 0:i.response)==null?void 0:e.data}},e4=async u=>{var i;const e={id_faculty:u.id_faculty,direction_cipher:u.direction_cipher,direction:u.direction,direction_en:u.direction_en};try{return await _.post(x.addDirection(),e)}catch(t){return(i=t==null?void 0:t.response)==null?void 0:i.data}},t4=async u=>{var i;const e={direction_cipher:u.direction_cipher,direction:u.direction,direction_en:u.direction_en};try{return await _.put(x.updateDirection(u.id_direction),e)}catch(t){return(i=t==null?void 0:t.response)==null?void 0:i.data}},i4=async u=>{var e;try{return await _.delete(x.deleteDirection(u))}catch(i){return(e=i==null?void 0:i.response)==null?void 0:e.data}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const b=globalThis.jotaiAtomCache.get("/home/ku01/mon/edugate/front/src/entities/vuzAdmin/direction/model/atoms.ts/directionsAtom",M([]));b.debugLabel="directionsAtom";const V=globalThis.jotaiAtomCache.get("/home/ku01/mon/edugate/front/src/entities/vuzAdmin/direction/model/atoms.ts/setDirectionsAtom",M(u=>u(b),async(u,e,{id_faculty:i})=>{const t=await u4(i);!t||t.error?e(b,[]):e(b,t.data||[])}));V.debugLabel="setDirectionsAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const s4=()=>q(b),c4=()=>R(V),a4=u=>{const e=s4(),i=c4(),[t,o]=d.exports.useState(!1),[a,h]=d.exports.useState(null),g=d.exports.useCallback(async()=>{if(!!u){o(!0),h(null);try{await i({id_faculty:u})}catch(l){h((l==null?void 0:l.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439")}finally{o(!1)}}},[u,i]);return{directions:e,loading:t,error:a,loadDirections:g}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const{Text:S}=N,r4=({directions:u,loading:e,error:i,facultyId:t,onRefresh:o,onEdit:a})=>{const h=p=>{a==null||a(p)},g=p=>{z.confirm({title:"\u0423\u0434\u0430\u043B\u0435\u043D\u0438\u0435 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F",centered:!0,icon:s(G,{}),content:`\u0412\u044B \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043B\u044C\u043D\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 "${p.direction}"?`,okText:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",okType:"danger",cancelText:"\u041E\u0442\u043C\u0435\u043D\u0430",async onOk(){try{const r=await i4(p.id_direction);r&&!r.error?(f.success("\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u043E"),o()):f.error((r==null?void 0:r.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u0438 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F")}catch(r){f.error((r==null?void 0:r.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0442\u0438")}}})},l=[{title:"\u2116",key:"index",width:60,align:"center",render:(p,r,D)=>D+1},{title:"\u0428\u0438\u0444\u0440",dataIndex:"direction_cipher",key:"direction_cipher",width:120},{title:"\u041F\u043E\u043B\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",dataIndex:"direction",key:"direction"},{title:"Name",dataIndex:"direction_en",key:"direction_en"},{title:"Id",dataIndex:"id_direction",key:"id_direction",width:80,align:"center"},{title:"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F",key:"actions",width:120,align:"center",render:(p,r)=>E(Q,{size:"middle",children:[s(Y,{style:{color:"#52c41a",fontSize:"18px",cursor:"pointer"},onClick:()=>h(r)}),s(P,{style:{color:"#ff4d4f",fontSize:"18px",cursor:"pointer"},onClick:()=>g(r)})]})}];return t?e?s("div",{className:"flex items-center justify-center h-64",children:s(S,{children:"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430..."})}):i?s("div",{className:"flex items-center justify-center h-64",children:s(S,{type:"danger",children:i})}):s("div",{className:I.customTable,children:s(J,{columns:l,dataSource:u,rowKey:"id_direction",pagination:!1})}):s("div",{className:"flex items-center justify-center h-64",children:s(S,{children:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u043A\u0443\u043B\u044C\u0442\u0435\u0442 \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0439"})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const o4="_modalContent_f6u4k_1",n4="_primaryButton_f6u4k_68",k={modalContent:o4,primaryButton:n4};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const l4=({open:u,onCancel:e,onSubmit:i,loading:t,editData:o})=>{const[a]=C.useForm(),h=C.useWatch("direction_cipher",a),g=C.useWatch("direction",a),l=C.useWatch("direction_en",a);d.exports.useEffect(()=>{u?o&&a.setFieldsValue(o):a.resetFields()},[u,o,a]);const p=!!((h==null?void 0:h.trim())&&(g==null?void 0:g.trim())&&(l==null?void 0:l.trim())),r=o?h!==o.direction_cipher||g!==o.direction||l!==o.direction_en:!0,D=p&&r,A=async()=>{try{const n=await a.validateFields();i(o?{...n,id_direction:o.id_direction}:n)}catch{}},j=n=>n.target.value.replace(/[^а-яА-ЯёЁ0-9\s\-.,()«»"']/g,""),w=n=>n.target.value.replace(/[^a-zA-Z0-9\s\-.,()""']/g,""),T=!!o;return s(z,{title:T?"\u0420\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F":"\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F",open:u,onCancel:e,onOk:A,okText:T?"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C":"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C",cancelText:"\u041E\u0442\u043C\u0435\u043D\u0430",confirmLoading:t,width:700,className:k.modalContent,okButtonProps:{className:k.primaryButton,disabled:!D},centered:!0,children:E(C,{form:a,layout:"vertical",preserve:!1,children:[s(C.Item,{label:"\u0428\u0438\u0444\u0440",name:"direction_cipher",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0448\u0438\u0444\u0440"},{pattern:/^[0-9]+$/,message:"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u0442\u043E\u043B\u044C\u043A\u043E \u0446\u0438\u0444\u0440\u044B"}],children:s(v,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0448\u0438\u0444\u0440 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F",size:"large",onChange:n=>{const F=n.target.value.replace(/[^0-9]/g,"");a.setFieldValue("direction_cipher",F)}})}),s(C.Item,{label:"\u041F\u043E\u043B\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",name:"direction",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435"},{pattern:/^[а-яА-ЯёЁ0-9\s\-.,()«»"']+$/,message:"\u0418\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435 \u0442\u043E\u043B\u044C\u043A\u043E \u0440\u0443\u0441\u0441\u043A\u0438\u0435 \u0431\u0443\u043A\u0432\u044B \u0438 \u0446\u0438\u0444\u0440\u044B"}],children:s(v,{placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043F\u043E\u043B\u043D\u043E\u0435 \u043D\u0430\u0437\u0432\u0430\u043D\u0438\u0435 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F",size:"large",onChange:n=>{const y=j(n);a.setFieldValue("direction",y)}})}),s(C.Item,{label:"Name",name:"direction_en",rules:[{required:!0,message:"Enter the name"},{pattern:/^[a-zA-Z0-9\s\-.,()""']+$/,message:"Use only English letters and numbers"}],children:s(v,{placeholder:"Enter direction name in English",size:"large",onChange:n=>{const y=w(n);a.setFieldValue("direction_en",y)}})})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(u,e){return this.cache.has(u)?this.cache.get(u):(this.cache.set(u,e),e)}};const{Title:h4}=N,B4=()=>{const{i18n:u}=U(),[e,i]=d.exports.useState([]),[t,o]=d.exports.useState(null),[a,h]=d.exports.useState(!1),[g,l]=d.exports.useState(!1),[p,r]=d.exports.useState(!1),[D,A]=d.exports.useState(null),{directions:j,loading:w,error:T,loadDirections:n}=a4(t);d.exports.useEffect(()=>{(async()=>{h(!0);try{const c=u.language==="ru"?"ru":"en",B=await H(c);B&&!B.error&&i(B.data||[])}catch(c){console.error("Error loading faculties:",c)}finally{h(!1)}})()},[u.language]),d.exports.useEffect(()=>{t&&n()},[t,n]);const y=m=>{o(m)},F=()=>{t&&n()},O=()=>{A(null),l(!0)},$=m=>{A(m),l(!0)},W=()=>{l(!1),A(null)},L=async m=>{if(!t&&!D){f.error("\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u043A\u0443\u043B\u044C\u0442\u0435\u0442");return}r(!0);try{let c;if(D)c=await t4({...m,id_direction:D.id_direction}),c&&!c.error?(f.success("\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u043E"),F(),l(!1),A(null)):f.error((c==null?void 0:c.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0438 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F");else{const B={...m,id_faculty:t};c=await e4(B),c&&!c.error?(f.success("\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E"),F(),l(!1)):f.error((c==null?void 0:c.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u0438\u0438 \u043D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u044F")}}catch(c){f.error((c==null?void 0:c.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u0435\u0442\u0438")}finally{r(!1)}};return E(Z,{children:[E("div",{style:{marginBottom:"24px"},children:[s(h4,{level:4,style:{marginBottom:"16px"},children:"\u041D\u0430\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435"}),E("div",{style:{display:"flex",gap:"16px",alignItems:"center"},children:[s(K,{style:{flex:1,height:40},placeholder:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0444\u0430\u043A\u0443\u043B\u044C\u0442\u0435\u0442",size:"large",loading:a,value:t,onChange:y,options:e.map(m=>({label:m.faculty,value:m.id_faculty}))}),s(X,{type:"primary",size:"large",className:I.primaryButton,style:{minWidth:"120px"},onClick:O,disabled:!t,children:"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C"})]})]}),s(r4,{directions:j,loading:w,error:T,facultyId:t,onRefresh:F,onEdit:$}),s(l4,{open:g,onCancel:W,onSubmit:L,loading:p,editData:D})]})};export{B4 as default};
