import{c as $,t as U,bT as Z,cT as J,r as h,u as B,j as t,e as s,bZ as L,cU as K,F as X,cV as Y,cW as Q,cX as ee,cY as P,R as te,cZ as ae}from"./index.dc8861ba.js";import{y as S}from"./index.7f582228.js";import{u as se,a as O,G as ue,C as re}from"./GenderSelector.98cc2e76.js";import{U as le}from"./index.f70f7227.js";import{S as oe}from"./index.3d0341d4.js";/**
 * @license lucide-react v0.548.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],ie=$("upload",ne);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const z={getDocuments:()=>"/abiturient/personal/documents",uploadDocument:()=>"/abiturient/personal/documents"};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const ce=async()=>{var e;try{const a=localStorage.getItem("EDUGATE_TOKEN"),u=a?JSON.parse(a):null;if(!u)return console.error("No token found in localStorage"),{data:null,error:!0,message:"\u0422\u043E\u043A\u0435\u043D \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"};const i=`${z.getDocuments()}?_t=${Date.now()}`;return await U.get(i,{headers:{Authorization:u}})}catch(a){return console.error("Error fetching abiturient documents:",a),(e=a==null?void 0:a.response)==null?void 0:e.data}},de=async e=>{var a;try{const u=localStorage.getItem("EDUGATE_TOKEN"),i=u?JSON.parse(u):null;if(!i)return console.error("No token found in localStorage"),{data:null,error:!0,message:"\u0422\u043E\u043A\u0435\u043D \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"};const c=new FormData;return c.append("id_document",String(e.id_document)),c.append("file",e.file),await U.post(z.uploadDocument(),c,{headers:{Authorization:i,"Content-Type":"multipart/form-data"}})}catch(u){return console.error("Error uploading abiturient document:",u),(a=u==null?void 0:u.response)==null?void 0:a.data}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const R=globalThis.jotaiAtomCache.get("/home/ku01/mon/edugate/front/src/entities/abiturient/documents/model/atoms.ts/documentsAtom",Z(null));R.debugLabel="documentsAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const he=()=>{const[e,a]=J(R),[u,i]=h.exports.useState(!1),[c,d]=h.exports.useState(null),{i18n:p}=B(),m=h.exports.useCallback(async()=>{var l;i(!0),d(null);try{const r=await ce();if((r==null?void 0:r.data)&&Array.isArray(r.data)){const n=r.data.map(v=>({...v,url_file:v.url_file?`${v.url_file.split("?")[0]}?t=${Date.now()}`:null}));a(n)}else if((l=r==null?void 0:r.data)!=null&&l.data){const n=r.data.data.map(v=>({...v,url_file:v.url_file?`${v.url_file.split("?")[0]}?t=${Date.now()}`:null}));a(n)}else a([])}catch(r){console.error("Error fetching documents:",r),d("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u043E\u0432"),a([])}finally{i(!1)}},[a]),o=h.exports.useCallback(async(l,r)=>{i(!0),d(null);try{const n=await de({id_document:l,file:r});return n&&!n.error?(a(null),await m(),{success:!0,message:n.message||"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D"}):(d("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430"),{success:!1,message:(n==null?void 0:n.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430"})}catch(n){return console.error("Error uploading document:",n),d("\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430"),{success:!1,message:"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430"}}finally{i(!1)}},[m,a]);return h.exports.useEffect(()=>{e===null&&m()},[e,m]),h.exports.useEffect(()=>{m()},[p.language]),{documents:e||[],isLoading:u,error:c,fetchDocuments:m,uploadDocument:o}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const me=({isOpen:e,onClose:a,onUpload:u,title:i,subtitle:c,documentType:d=1})=>{const[p,m]=h.exports.useState(null),[o,l]=h.exports.useState(null),[r,n]=h.exports.useState(!1),v=h.exports.useRef(null);if(!e)return null;const T=N=>{var b;const w=(b=N.target.files)==null?void 0:b[0];if(w)if(w.type.startsWith("image/")&&d===1)K(w,_=>{m(_);const k=new FileReader;k.onloadend=()=>{l(k.result)},k.readAsDataURL(_)});else if(m(w),w.type.startsWith("image/")){const _=new FileReader;_.onloadend=()=>{l(_.result)},_.readAsDataURL(w)}else l(null)},I=async()=>{if(!!p){n(!0);try{await u(p),A()}catch(N){console.error("Error uploading file:",N)}finally{n(!1)}}},A=()=>{m(null),l(null),n(!1),a()};return t("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[s("div",{className:"flex justify-between items-start mb-4",children:[s("div",{children:[t("h2",{className:"text-xl font-semibold",children:i}),c&&t("p",{className:"text-sm text-gray-500 mt-1",children:c})]}),t("button",{onClick:A,className:"text-gray-400 hover:text-gray-600",disabled:r,children:t(L,{className:"w-6 h-6"})})]}),s("div",{className:"mb-4",children:[t("input",{ref:v,type:"file",onChange:T,accept:d===1?"image/*":d===2?".pdf,image/*":"*",className:"hidden",disabled:r}),t("button",{onClick:()=>{var N;return(N=v.current)==null?void 0:N.click()},className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-8 hover:border-blue-500 transition-colors",disabled:r,children:o?t("img",{src:o,alt:"Preview",className:"w-full h-48 object-contain"}):p?s("div",{className:"text-center",children:[t("p",{className:"text-gray-700",children:p.name}),s("p",{className:"text-sm text-gray-500 mt-1",children:[(p.size/1024/1024).toFixed(2)," MB"]})]}):s("div",{className:"text-center",children:[t("p",{className:"text-gray-500",children:"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u0434\u043B\u044F \u0432\u044B\u0431\u043E\u0440\u0430 \u0444\u0430\u0439\u043B\u0430"}),t("p",{className:"text-sm text-gray-400 mt-1",children:"\u041F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044E\u0442\u0441\u044F \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F \u0438 PDF"})]})})]}),s("div",{className:"flex gap-3",children:[t("button",{onClick:A,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:r,children:"\u041E\u0442\u043C\u0435\u043D\u0430"}),t("button",{onClick:I,disabled:!p||r,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:r?"\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430...":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C"})]})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const ge=({isOpen:e,imageUrl:a,title:u,onClose:i})=>{if(!e)return null;const c=a==null?void 0:a.split("?")[0].toLowerCase().endsWith(".pdf");return s("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",onClick:i,children:[t("button",{onClick:i,className:"absolute top-4 right-4 text-white hover:text-gray-300 transition-colors z-10",children:t(L,{className:"w-8 h-8"})}),u&&t("div",{className:"absolute top-4 left-4 text-white text-lg font-semibold z-10",children:u}),t("div",{className:"w-full h-full flex items-center justify-center p-4",children:c?t("iframe",{src:a,title:u||"PDF Document",className:"w-[95vw] h-[95vh] bg-white rounded-lg shadow-2xl",onClick:d=>d.stopPropagation()}):t("img",{src:a,alt:u||"Document",className:"max-w-[90vw] max-h-[90vh] object-contain",onClick:d=>d.stopPropagation()})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const pe=({isOpen:e,onClose:a,onSubmit:u,initialData:i,currentPhotoUrl:c})=>{const{genders:d,loading:p}=se(),{countries:m,loading:o}=O(),{t:l}=B(),[r,n]=h.exports.useState(i||{surname:"",surname_en:"",names:"",names_en:"",patronymic:"",patronymic_en:"",birth_date:"",passport:"",passport_date:"",email:"",telephone:"",img:null,id_gender:void 0,id_country:void 0,name_org:"",documents:"",id_education_doc:void 0,date_document:"",serial_number:""}),[v,T]=h.exports.useState(c||""),[I,A]=h.exports.useState(!!c),[N,w]=h.exports.useState(!1),b=h.exports.useCallback(f=>{const{name:x,value:C}=f.target;if(x==="passport"){const y=C.replace(/[^A-Z0-9]/gi,"").toUpperCase();n(F=>({...F,passport:y}));return}if(x==="serial_number"){const y=C.replace(/[^A-Z0-9]/gi,"").toUpperCase();n(F=>({...F,serial_number:y}));return}if(x==="telephone"){const y=C.replace(/[^0-9]/g,"");n(F=>({...F,telephone:y}));return}if(x==="fatherland"){n(y=>({...y,patronymic:C}));return}n(y=>({...y,[x]:C}))},[]),_=f=>{var C;const x=(C=f.target.files)==null?void 0:C[0];if(x){A(!0),n({...r,img:x});const y=new FileReader;y.readAsDataURL(x),y.onload=()=>{T(y.result)}}},k=()=>{const f=document.querySelector("#edit-img");f&&(f.value=""),A(!1),n({...r,img:null}),T("")},M=async f=>{f.preventDefault(),w(!0);try{await u(r),a()}catch(x){console.error("Error updating personal data:",x)}finally{w(!1)}};return e?t("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:s("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh]  mx-4",children:[s("div",{className:"bg-white border-b border-gray-200 px-4 py-4 flex justify-between items-center",children:[t("h2",{className:"text-xl font-semibold text-gray-900",children:l("auth:form.EditPersonalData")}),t("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors items-center justify-center flex",type:"button",children:t(L,{className:"w-4 h-4"})})]}),s("form",{onSubmit:M,className:"p-4",children:[s("div",{className:"flex justify-between gap-6",children:[s("div",{className:"space-y-2 flex-1",children:[s("div",{children:[t("label",{className:"block text-sm font-semibold  mb-1",children:"Last name"}),t("input",{type:"text",name:"surname_en",value:r.surname_en||"",onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm  focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:l("site:register.surname")||""})]}),s("div",{children:[t("label",{className:"block text-sm font-semibold  mb-1",children:"First name"}),t("input",{type:"text",name:"names_en",value:r.names_en||"",onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm  focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Name"})]}),s("div",{children:[t("label",{className:"block text-sm font-semibold  mb-1",children:"Middle name"}),t("input",{type:"text",name:"patronymic_en",value:r.patronymic_en||"",onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm  focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"Middle name"})]})]}),s("div",{className:"space-y-2 flex-1",children:[s("div",{children:[t("label",{className:"block text-sm font-semibold  mb-1",children:l("site:register.surname")}),t("input",{type:"text",name:"surname",required:!0,value:r.surname,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm  focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:l("site:register.surname")||""})]}),s("div",{children:[t("label",{className:"block text-sm font-semibold  mb-1",children:l("site:register.name")}),t("input",{type:"text",name:"names",required:!0,value:r.names,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:l("site:register.name")||""})]}),s("div",{children:[t("label",{className:"block text-sm font-semibold  mb-1",children:l("site:register.fatherland")}),t("input",{type:"text",name:"fatherland",value:r.patronymic,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:l("site:register.fatherland")||""})]})]}),s("div",{className:"flex flex-col items-center",children:[t("label",{className:"block text-sm font-semibold  mb-3 text-center",children:l("site:register.photo")}),t("div",{className:"border border-gray-300 rounded-lg p-4 w-32 bg-white",children:v?t("img",{src:v,alt:"avatar",className:"w-full h-32 object-cover rounded"}):s("div",{className:"w-full h-32 flex flex-col items-center justify-center bg-gray-50 rounded text-gray-400 text-xs",children:[t("svg",{className:"w-12 h-12 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"NOT FOUND"]})}),s("div",{className:"mt-3 w-32",children:[I?t("button",{type:"button",onClick:k,className:"w-full text-xs font-medium border border-gray-300  bg-white rounded-md px-3 py-1.5 hover:bg-gray-50 transition-colors cursor-pointer",children:l("site:register.removePhoto")}):t("label",{htmlFor:"edit-img",className:"w-full text-xs font-medium border border-gray-300  bg-white rounded-md px-3 py-1.5 cursor-pointer block text-center hover:bg-gray-50 transition-colors",children:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C"}),t("input",{type:"file",id:"edit-img",accept:"image/*",onChange:_,className:"hidden"})]})]})]}),t("div",{className:"space-y-2 mt-2",children:s("div",{className:"grid grid-cols-2 gap-4",children:[s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:register.dateBirth")}),t("input",{type:"date",name:"birth_date",required:!0,value:r.birth_date,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:register.gender")}),t(ue,{genders:d,value:typeof r.id_gender=="number"?r.id_gender:"",onChange:f=>n({...r,id_gender:typeof f=="number"?f:void 0}),loading:p,className:"w-full h-8 [&_.ant-select-selector] [&_.ant-select-selector]:!rounded-lg [&_.ant-select-selector]:!h-8 [&_.ant-select-selector]:!shadow-none hover:[&_.ant-select-selector]:!border-blue-500 focus:[&_.ant-select-selector]:!border-blue-500 focus:[&_.ant-select-selector]:!ring-1 focus:[&_.ant-select-selector]:!ring-blue-500"})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:register.passport")}),t("input",{type:"text",name:"passport",required:!0,value:r.passport,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"AC1234567"})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:register.datePassport")}),t("input",{type:"date",name:"passport_date",required:!0,value:r.passport_date,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:register.country")}),t(re,{countries:m,value:typeof r.id_country=="number"?r.id_country:"",onChange:f=>n({...r,id_country:f===""?void 0:f}),loading:o,className:"w-full h-8 [&_.ant-select-selector] [&_.ant-select-selector]:!rounded-lg [&_.ant-select-selector]:!h-8 [&_.ant-select-selector]:!shadow-none hover:[&_.ant-select-selector]:!border-blue-500 focus:[&_.ant-select-selector]:!border-blue-500 focus:[&_.ant-select-selector]:!ring-1 focus:[&_.ant-select-selector]:!ring-blue-500"})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:register.tel")}),t("input",{type:"tel",name:"telephone",value:r.telephone,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"996705373464"})]}),s("div",{children:[s("label",{className:" text-sm font-semibold  mb-1",children:[l("site:register.email")," ",t("span",{className:"text-red-500",children:"*"})]}),t("input",{type:"email",name:"email",required:!0,value:r.email,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"email@example.com"})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:personalInfo.educ_doc")}),s("select",{name:"id_education_doc",value:r.id_education_doc||"",onChange:f=>{const x=f.target.value;n({...r,id_education_doc:x?Number(x):void 0})},className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500 bg-white",children:[t("option",{value:"",children:l("site:personalInfo.chooseDocumentType")}),t("option",{value:"1",children:l("site:personalInfo.attestat")}),t("option",{value:"2",children:l("site:personalInfo.diplom")})]})]}),s("div",{children:[t("label",{className:" text-sm font-semibold  mb-1",children:l("site:personalInfo.serial_number")}),t("input",{type:"text",name:"serial_number",value:r.serial_number,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:"123456"})]}),s("div",{children:[t("label",{className:"text-sm font-semibold  mb-1",children:l("site:register.datePassport")}),t("input",{type:"date",name:"date_document",value:r.date_document,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})]}),s("div",{children:[t("label",{className:"text-sm font-semibold  mb-1",children:l("site:personalInfo.nameOrg")}),t("input",{type:"text",name:"name_org",value:r.name_org,onChange:b,className:"w-full border border-gray-300 rounded-lg h-8 px-3 text-sm outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500",placeholder:""})]})]})}),t("div",{className:"flex justify-end gap-4 border-t border-gray-200",children:t("button",{type:"submit",className:"px-8 py-2.5 bg-[#1567DA] border-none text-white rounded-lg font-medium cursor-pointer",disabled:N,children:l(N?"cm:actions.saving":"cm:actions.save")})})]})]})}):null};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const be=({title:e,subtitle:a,imageUrl:u,onUpload:i,onImageClick:c,buttonText:d="\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0444\u0430\u0439\u043B"})=>{const p=u==null?void 0:u.split("?")[0].toLowerCase().endsWith(".pdf");return s("div",{className:"bg-white rounded-lg p-6 shadow-[0_6px_30px_rgba(0,0,0,0.08)] flex flex-col h-full",children:[s("div",{className:"mb-4 min-h-[60px]",children:[t("h3",{className:"text-lg font-semibold",children:e}),a?t("p",{className:"text-sm text-gray-400 mt-1",children:a}):t("div",{className:"h-5"})]}),t("div",{className:"bg-[#E5E5E5] rounded-lg h-64 flex flex-col items-center justify-center mb-4 flex-shrink-0",children:u?p?s("div",{className:"w-full h-full flex flex-col items-center justify-center cursor-pointer hover:bg-gray-200 transition-colors rounded-lg",onClick:c,children:[t("svg",{className:"w-20 h-20 text-red-500 mb-2",fill:"currentColor",viewBox:"0 0 20 20",children:t("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm2 6a1 1 0 011-1h6a1 1 0 110 2H7a1 1 0 01-1-1zm1 3a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})}),t("p",{className:"text-gray-700 font-medium",children:"PDF \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442"}),t("p",{className:"text-sm text-gray-500 mt-1",children:"\u041D\u0430\u0436\u043C\u0438\u0442\u0435 \u0434\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430"})]}):t("img",{src:u,alt:e,className:"w-full h-full object-contain rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:c}):s(X,{children:[t("div",{className:"w-24 h-24 mb-4",children:s("svg",{viewBox:"0 0 100 100",className:"fill-gray-400",children:[t("rect",{x:"20",y:"30",width:"60",height:"40",rx:"2"}),t("circle",{cx:"40",cy:"45",r:"8"}),t("path",{d:"M25 60 L40 50 L55 60 L70 45 L75 50 L75 65 L25 65 Z"})]})}),t("p",{className:"text-gray-500 text-lg font-semibold",children:"NOT FOUND"})]})}),s("button",{onClick:i,className:"flex items-center justify-center gap-2 text-blue-500 hover:text-white hover:bg-[#FF6B00] transition-all w-full border-none bg-transparent py-2 px-4 rounded",children:[t(ie,{className:"w-4 h-4"}),t("span",{className:"text-sm",children:d})]})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const fe=({documents:e,onUploadDocument:a,onImageClick:u})=>{const{t:i}=B(),c=(o,l)=>{a&&a(o,l)},d=(o,l)=>{o&&u&&u(o,l)},p=e.filter(o=>![13,14,5].includes(o.id_document)),m=e.filter(o=>[13,14,5].includes(o.id_document));return s("div",{className:"space-y-8",children:[t("div",{className:"grid grid-cols-2 gap-6",children:p.map(o=>t(be,{title:o.document_name,imageUrl:o.url_file||void 0,onUpload:()=>c(o.id_document,o.type),onImageClick:()=>d(o.url_file,o.document_name),buttonText:o.url_file?i("site:Buttons.edit_file"):i("site:Buttons.upload_file")},o.id_document))}),m.length>0&&t("div",{className:"space-y-4",children:m.map(o=>{var l;return s("div",{className:"flex items-center justify-between p-4 bg-[#F3F4F6] rounded-lg border border-gray-200",children:[s("div",{className:"flex items-center gap-3",children:[t("svg",{className:"w-6 h-6 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg",children:t("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h4.586A2 2 0 0112 2.586L15.414 6A2 2 0 0116 7.414V16a2 2 0 01-2 2H6a2 2 0 01-2-2V4z",clipRule:"evenodd"})}),s("div",{children:[t("p",{className:"text-sm font-medium text-gray-900",children:o.document_name}),o.url_file&&t("p",{className:"text-xs text-gray-500",children:((l=o.url_file.split("/").pop())==null?void 0:l.split("?")[0])||"\u0424\u0430\u0439\u043B \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D"})]})]}),s("button",{onClick:()=>c(o.id_document,o.type),className:"text-sm text-blue-600 hover:text-white hover:bg-[#FF6B00] font-medium flex items-center gap-1 border-none bg-transparent py-2 px-4 rounded transition-all",children:[t("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:t("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),o.url_file?i("site:Buttons.edit_file"):i("site:Buttons.upload_file")]})]},o.id_document)})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const D=({label:e,value:a})=>s("div",{className:"mb-3",children:[t("div",{className:"text-sm font-semibold text-gray-700 ",children:e}),t("div",{className:"text-base text-gray-900",children:a||"-"})]});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const xe=({user:e,onUpdate:a})=>{var o;const{t:u}=B(),{countries:i}=O(),c=((o=i.find(l=>l.id_country===e.id_country))==null?void 0:o.country)||"-",d=()=>typeof e.img=="string"?e.img:null,p=()=>e.id_gender===1?u("site:personalInfo.male"):e.id_gender===2?u("site:personalInfo.female"):"-",m=()=>e.id_education_doc===1?u("site:personalInfo.attestat"):e.id_education_doc===2?u("site:personalInfo.diplom"):"-";return t("div",{className:"bg-white rounded-lg shadow-[0_6px_30px_rgba(0,0,0,0.08)] mb-8",children:s("div",{className:"grid grid-cols-4 gap-8 px-8 py-8",children:[s("div",{className:"mb-5 flex flex-col items-center justify-between",children:[t("div",{className:"flex justify-center mb-5",children:t(le,{imageUrl:d()})}),t("div",{className:"",children:t("button",{onClick:a,className:"bg-[#1567DA] text-white px-6 py-2.5 rounded-lg text-sm font-medium border-none cursor-pointer hover:bg-[#FF6B00] transition-colors",children:u("cm:actions.update")})})]}),s("div",{className:"flex flex-col",children:[s("div",{className:"mb-3",children:[t("div",{className:"text-sm font-semibold text-gray-700",children:u("site:register.surname")}),t("div",{className:"text-base text-gray-900",children:e.surname||"-"}),e.surname_en&&t("div",{className:"text-sm text-gray-500 mt-0.5",children:e.surname_en})]}),s("div",{className:"mb-3",children:[t("div",{className:"text-sm font-semibold text-gray-700",children:u("site:register.name")}),t("div",{className:"text-base text-gray-900",children:e.names||"-"}),e.names_en&&t("div",{className:"text-sm text-gray-500 mt-0.5",children:e.names_en})]}),s("div",{className:"mb-3",children:[t("div",{className:"text-sm font-semibold text-gray-700",children:u("site:register.fatherland")}),t("div",{className:"text-base text-gray-900",children:e.patronymic||"-"}),e.patronymic_en&&t("div",{className:"text-sm text-gray-500 mt-0.5",children:e.patronymic_en})]}),t(D,{label:u("site:register.gender"),value:p()}),t(D,{label:u("site:register.dateBirth"),value:e.birth_date})]}),s("div",{className:"flex flex-col",children:[t(D,{label:u("site:register.passport"),value:e.passport}),t(D,{label:u("site:register.datePassport"),value:e.passport_date}),t(D,{label:u("site:register.country"),value:c}),t(D,{label:u("site:register.tel"),value:e.telephone}),t(D,{label:u("site:register.email"),value:e.email})]}),s("div",{className:"flex flex-col",children:[t(D,{label:u("site:personalInfo.educ_doc"),value:m()}),t(D,{label:u("site:personalInfo.serial_number"),value:e.serial_number}),t(D,{label:u("site:personalInfo.DateOfIssue"),value:e.date_document})]})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const ye=()=>{const e=Y(),a=Q(),u=ee(),i=P(),{documents:c,uploadDocument:d,fetchDocuments:p}=he(),{t:m}=B(),[o,l]=h.exports.useState(!1),[r,n]=h.exports.useState(null),[v,T]=h.exports.useState(1),[I,A]=h.exports.useState(!1),[N,w]=h.exports.useState(""),[b,_]=h.exports.useState(""),[k,M]=h.exports.useState(!1),[f,x]=h.exports.useState(!1);te.useEffect(()=>{p()},[p]);const C=(E,j)=>{n(E),T(j),l(!0)},y=()=>{l(!1),n(null),T(1)},F=async E=>{if(r===null)return;const j=await d(r,E);j.success?(S.success(j.message||"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043D"),y()):S.error(j.message||"\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0435 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442\u0430")},V=()=>{M(!0)},q=async E=>{try{x(!0),await ae(E),S.success("\u0414\u0430\u043D\u043D\u044B\u0435 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u044B"),await i(),M(!1)}catch(j){S.error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0440\u0438 \u043E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0438 \u0434\u0430\u043D\u043D\u044B\u0445"),console.error("Error updating personal data:",j)}finally{x(!1)}},G=(E,j)=>{w(E),_(j),A(!0)},H=()=>{A(!1)},W=E=>{switch(E){case 15:return"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442, \u0443\u0434\u043E\u0441\u0442\u043E\u0432\u0435\u0440\u044F\u044E\u0449\u0438\u0439 \u043B\u0438\u0447\u043D\u043E\u0441\u0442\u044C";case 2:return"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u043E\u0431 \u043E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\u0438\u0438 (\u043B\u0438\u0446\u0435\u0432\u0430\u044F \u0441\u0442\u043E\u0440\u043E\u043D\u0430)";case 3:return"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442 \u043E\u0431 \u043E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\u0438\u0438 (\u043E\u0431\u0440\u0430\u0442\u043D\u0430\u044F \u0441\u0442\u043E\u0440\u043E\u043D\u0430)";case 4:return"\u0414\u043E\u043F\u043E\u043B\u043D\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439 \u0434\u043E\u043A\u0443\u043C\u0435\u043D\u0442";case 14:return"\u041F\u0440\u0438\u0433\u043B\u0430\u0441\u0438\u0442\u0435\u043B\u044C\u043D\u044B\u0439";case 1:return"\u0417\u0430\u0433\u0440\u0430\u043D\u043F\u0430\u0441\u043F\u043E\u0440\u0442";case 13:return"\u041C\u0435\u0434 \u0441\u043F\u0440\u0430\u0432\u043A\u0430";case 5:return"\u0421\u0432\u0438\u0434\u0435\u0442\u0435\u043B\u044C\u0441\u0442\u0432\u043E \u043E \u043F\u0440\u0438\u0437\u043D\u0430\u043D\u0438\u0438 \u0438\u043D\u043E\u0441\u0442\u0440\u0430\u043D\u043D\u043E\u0433\u043E \u043E\u0431\u0440\u0430\u0437\u043E\u0432\u0430\u043D\u0438\u044F (\u043D\u043E\u0441\u0442\u0440\u0438\u0444\u0438\u043A\u0430\u0446\u0438\u044F)";default:return"\u0414\u043E\u043A\u0443\u043C\u0435\u043D\u0442"}};if(a)return t("div",{className:"bg-white rounded-[16px] p-8 flex justify-center items-center min-h-[400px]",children:t(oe,{size:"large"})});if(u)return t("div",{className:"bg-white rounded-[16px] p-8 flex justify-center items-center min-h-[400px]",children:t("div",{className:"text-lg text-red-500",children:u})});if(!e||!e.length)return t("div",{className:"bg-white rounded-[16px] p-8 flex justify-center items-center min-h-[400px]",children:t("div",{className:"text-lg text-gray-600",children:m("noData")||"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"})});const g=e[0];return s("div",{className:"bg-white rounded-[16px]",children:[t("div",{className:"bg-white z-10 px-5 pt-2 pb-4 rounded-t-[16px]",children:t("h1",{className:"text-2xl font-semibold",children:m("sidebar:sideBar.personal")})}),s("div",{className:"px-5 space-y-6",children:[t(xe,{user:g,onUpdate:V}),t(fe,{documents:c,onUploadDocument:C,onImageClick:G})]}),r!==null&&t(me,{isOpen:o,onClose:y,onUpload:F,title:W(r),documentType:v}),t(ge,{isOpen:I,imageUrl:N,title:b,onClose:H}),t(pe,{isOpen:k,onClose:()=>M(!1),onSubmit:q,initialData:{surname:g.surname||"",surname_en:g.surname_en||"",names:g.names||"",names_en:g.names_en||"",patronymic:g.patronymic||"",patronymic_en:g.patronymic_en||"",birth_date:g.birth_date||"",passport:g.passport||"",passport_date:g.passport_date||"",email:g.email||"",telephone:g.telephone||"",img:null,id_gender:g.id_gender,id_country:g.id_country,name_org:g.name_org||"",id_education_doc:g.id_education_doc,date_document:g.date_document||"",serial_number:g.serial_number||""},currentPhotoUrl:typeof g.img=="string"?g.img:""}),f&&t("div",{className:"fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50",children:t("div",{className:"bg-white rounded-lg p-6 shadow-xl",children:t("div",{className:"text-lg font-medium",children:"\u041E\u0431\u043D\u043E\u0432\u043B\u0435\u043D\u0438\u0435 \u0434\u0430\u043D\u043D\u044B\u0445..."})})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};const De=()=>{const e=P();return h.exports.useEffect(()=>{e()},[e]),t("div",{className:"bg-white p-6",children:t(ye,{})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,a){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,a),a)}};export{De as PersonalPage};
