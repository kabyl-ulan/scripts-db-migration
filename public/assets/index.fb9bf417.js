import{t as A,r,u as N,j as m,c_ as be,e as p,bL as _,B as Se,F as ve,f as Ae}from"./index.dc8861ba.js";import{A as we}from"./index.61b3217a.js";import{g as Ce}from"./index.393baa21.js";import{y as T}from"./index.7f582228.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const x={getEducationLanguages:()=>"/abiturient/education-language",getRegions:()=>"/abiturient/regions",getUniversities:()=>"/abiturient/universities",getFaculties:()=>"/abiturient/faculties",getDirections:()=>"/abiturient/directions",getPaymentForms:()=>"/abiturient/bk",getSpecialties:()=>"/abiturient/specialties",getFormEducations:()=>"/abiturient/form-educations"};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const _e=async(e="en")=>await A.get(x.getEducationLanguages(),{params:{lang:e}}),Oe=async(e,t)=>await A.get(x.getRegions(),{params:{lang:e,id_education_lang:t}}),xe=async(e,t,y,a)=>await A.get(x.getUniversities(),{params:{lang:e,id_region:t,id_education_lang:y,type_univer:a}}),je=async(e,t,y)=>await A.get(x.getFaculties(),{params:{lang:e,id_university:t,id_education_lang:y}}),Fe=async(e,t,y)=>await A.get(x.getDirections(),{params:{lang:e,id_faculty:t,id_education_lang:y}}),De=async(e,t,y)=>await A.get(x.getPaymentForms(),{params:{lang:e,id_direction:t,id_education_lang:y}}),Te=async(e,t,y,a)=>await A.get(x.getSpecialties(),{params:{lang:e,id_direction:t,id_bk:y,id_education_lang:a}}),Ee=async(e,t,y,a,u)=>await A.get(x.getFormEducations(),{params:{lang:e,id_education_lang:u,id_direction:t,id_bk:y,id_speciality:a}});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Me=({open:e,onClose:t,onSubmit:y})=>{var q;const[a,u]=r.exports.useState({educationDirection:void 0,languageOfStudy:void 0,region:void 0,university:void 0,faculty:void 0,direction:void 0,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0}),{t:d,i18n:w}=N(["site","selector"]),[S,D]=r.exports.useState([]),[F,h]=r.exports.useState([]),[l,b]=r.exports.useState([]),[j,E]=r.exports.useState([]),[G,H]=r.exports.useState([]),[J,K]=r.exports.useState([]),[Q,V]=r.exports.useState([]),[W,X]=r.exports.useState([]),[Y,Z]=r.exports.useState([]),[ee,P]=r.exports.useState(!1),[te,L]=r.exports.useState(!1),[ae,k]=r.exports.useState(!1),[ie,U]=r.exports.useState(!1),[oe,B]=r.exports.useState(!1),[se,R]=r.exports.useState(!1),[ce,$]=r.exports.useState(!1),[ne,I]=r.exports.useState(!1),O=((q=F.find(i=>i.value===a.languageOfStudy))==null?void 0:q.code)||"ru",le=async()=>{try{const i=await Ce();if(i!=null&&i.data){const s=i.data.filter(o=>o.id_education_direction!==0).sort((o,c)=>o.sort-c.sort).map(o=>({label:w.language==="ru"?o.education_direction_ru:o.education_direction_en,value:o.id_education_direction}));D(s)}}catch(i){console.error("Error loading education directions:",i)}},re=async()=>{var i;try{P(!0);const s=await _e(O),o=((i=s==null?void 0:s.data)==null?void 0:i.data)||(s==null?void 0:s.data);if(Array.isArray(o)){const c=o.map(n=>({label:n.education_language,value:n.id_education_language}));h(c)}}catch(s){console.error("Error loading languages:",s)}finally{P(!1)}},ue=async i=>{var s;try{L(!0);const o=await Oe(O,i),c=((s=o==null?void 0:o.data)==null?void 0:s.data)||(o==null?void 0:o.data);if(Array.isArray(c)){const n=c.map(g=>({label:g.name||g.region,value:g.id||g.id_region}));b(n)}}catch{}finally{L(!1)}},de=async(i,s,o)=>{var c;try{k(!0);const n=await xe(O,i,s,o),g=((c=n==null?void 0:n.data)==null?void 0:c.data)||(n==null?void 0:n.data);if(Array.isArray(g)){const f=g.map(v=>({label:v.name||v.university_name,value:v.id||v.id_university}));E(f)}}catch{}finally{k(!1)}},he=async(i,s)=>{var o;try{U(!0);const c=await je(O,i,s),n=((o=c==null?void 0:c.data)==null?void 0:o.data)||(c==null?void 0:c.data);if(Array.isArray(n)){const g=n.map(f=>({label:f.name||f.faculty,value:f.id||f.id_faculty}));H(g)}}catch{}finally{U(!1)}},ge=async(i,s)=>{var o;try{B(!0);const c=await Fe(O,i,s),n=((o=c==null?void 0:c.data)==null?void 0:o.data)||(c==null?void 0:c.data);if(Array.isArray(n)){const g=n.map(f=>({label:f.name||f.direction,value:f.id||f.id_direction}));K(g)}}catch{}finally{B(!1)}},pe=async(i,s)=>{var o;try{R(!0);const c=await De(O,i,s),n=((o=c==null?void 0:c.data)==null?void 0:o.data)||(c==null?void 0:c.data);if(Array.isArray(n)){const g=n.map(f=>({label:f.name||f.bk,value:f.id||f.id_bk}));V(g)}}catch{}finally{R(!1)}},fe=async(i,s,o)=>{var c;try{$(!0);const n=await Te(O,i,s,o),g=((c=n==null?void 0:n.data)==null?void 0:c.data)||(n==null?void 0:n.data);if(Array.isArray(g)){const f=g.map(v=>({label:v.name||v.specialty,value:v.id||v.id_specialty}));X(f)}}catch{}finally{$(!1)}},ye=async(i,s,o,c)=>{var n;try{I(!0);const g=await Ee(O,i,s,o,c),f=((n=g==null?void 0:g.data)==null?void 0:n.data)||(g==null?void 0:g.data);if(Array.isArray(f)){const v=f.map(M=>({label:M.name||M.learning,value:M.id||M.id_learning}));Z(v)}}catch{}finally{I(!1)}},C=async(i,s)=>{u(o=>({...o,[i]:s})),i==="educationDirection"&&s?u(o=>({...o,languageOfStudy:void 0,region:void 0,university:void 0,faculty:void 0,direction:void 0,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0})):i==="languageOfStudy"&&s?(await ue(s),u(o=>({...o,region:void 0,university:void 0,faculty:void 0,direction:void 0,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0}))):i==="region"&&s&&a.languageOfStudy&&a.educationDirection?(await de(s,a.languageOfStudy,a.educationDirection),u(o=>({...o,university:void 0,faculty:void 0,direction:void 0,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0}))):i==="university"&&s&&a.languageOfStudy?(await he(s,a.languageOfStudy),u(o=>({...o,faculty:void 0,direction:void 0,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0}))):i==="faculty"&&s&&a.languageOfStudy?(await ge(s,a.languageOfStudy),u(o=>({...o,direction:void 0,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0}))):i==="direction"&&s&&a.languageOfStudy?(await pe(s,a.languageOfStudy),u(o=>({...o,formOfPayment:void 0,specialtySpecialization:void 0,formOfStudy:void 0}))):i==="formOfPayment"&&s&&a.direction&&a.languageOfStudy?(await fe(a.direction,s,a.languageOfStudy),u(o=>({...o,specialtySpecialization:void 0,formOfStudy:void 0}))):i==="specialtySpecialization"&&s&&a.direction&&a.formOfPayment&&a.languageOfStudy&&(await ye(a.direction,a.formOfPayment,s,a.languageOfStudy),u(o=>({...o,formOfStudy:void 0})))},me=()=>{y(a)};return r.exports.useEffect(()=>{e&&(le(),re())},[e]),m(be,{open:e,onCancel:t,title:d("selector:Select.select_vuz"),footer:null,width:700,children:p("div",{className:"flex flex-col gap-2",children:[p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.select_direction_title"),":"]}),m(_,{placeholder:d("selector:Select.select_direction_study"),className:"w-full",size:"middle",value:a.educationDirection,onChange:i=>C("educationDirection",i),options:S})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.education"),":"]}),m(_,{placeholder:d("selector:Select.select_education"),className:"w-full",size:"middle",value:a.languageOfStudy,onChange:i=>C("languageOfStudy",i),options:F,loading:ee,disabled:!a.educationDirection})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.select_region"),":"]}),m(_,{placeholder:d("selector:Select.select_region"),className:"w-full",size:"middle",value:a.region,onChange:i=>C("region",i),options:l,loading:te,disabled:!a.languageOfStudy})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.select_vuz"),":"]}),m(_,{placeholder:d("selector:Select.select_vuz"),className:"w-full",size:"middle",value:a.university,onChange:i=>C("university",i),options:j,loading:ae,disabled:!a.region})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.faculty"),":"]}),m(_,{placeholder:d("selector:Select.select_faculty"),className:"w-full",size:"middle",value:a.faculty,onChange:i=>C("faculty",i),options:G,loading:ie,disabled:!a.university})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.direction"),":"]}),m(_,{placeholder:d("selector:Select.select_direction"),className:"w-full",size:"middle",value:a.direction,onChange:i=>C("direction",i),options:J,loading:oe,disabled:!a.faculty})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.payment_form"),":"]}),m(_,{placeholder:d("selector:Select.select_payment_form"),className:"w-full",size:"middle",value:a.formOfPayment,onChange:i=>C("formOfPayment",i),options:Q,loading:se,disabled:!a.direction})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.speciality"),":"]}),m(_,{placeholder:d("selector:Select.select_speciality"),className:"w-full",size:"middle",value:a.specialtySpecialization,onChange:i=>C("specialtySpecialization",i),options:W,loading:ce,disabled:!a.formOfPayment})]}),p("div",{children:[p("label",{className:"block mb-2 font-medium",children:[d("selector:Select.learning"),":"]}),m(_,{placeholder:d("selector:Select.select_learning"),className:"w-full",size:"middle",value:a.formOfStudy,onChange:i=>C("formOfStudy",i),options:Y,loading:ne,disabled:!a.specialtySpecialization})]}),m("div",{className:"flex justify-end mt-4",children:m(Se,{type:"primary",onClick:me,className:"w-full md:w-auto !bg-[#1567DA] text-white hover:!bg-[#FF6B00] transition-colors",children:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C"})})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const z={getApplications:()=>"/abiturient/applications",createApplication:()=>"/abiturient/applications",deleteApplication:e=>`/abiturient/applications/${e}`};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Ne=async()=>await A.get(z.getApplications()),ze=async e=>await A.post(z.createApplication(),e),Pe=async e=>await A.delete(z.deleteApplication(e));globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const Le=()=>{const{i18n:e}=N(),[t,y]=r.exports.useState([]),[a,u]=r.exports.useState(!0),[d,w]=r.exports.useState(null),S=r.exports.useCallback(async()=>{try{u(!0),w(null);const h=await Ne();let l=[];h&&(Array.isArray(h)?l=h:h.data&&Array.isArray(h.data)?l=h.data:h.data&&h.data.applications?l=h.data.applications:h.applications&&(l=h.applications)),y(l)}catch(h){const l=(h==null?void 0:h.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0437\u0430\u0433\u0440\u0443\u0437\u043A\u0438 \u0437\u0430\u044F\u0432\u043E\u043A";w(l),console.error("\u274C Error loading applications:",h),T.error(l)}finally{u(!1)}},[]),D=r.exports.useCallback(async h=>{try{u(!0),w(null);const l=await ze(h);if(l!=null&&l.data)return await S(),T.success("\u0417\u0430\u044F\u0432\u043A\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u043D\u0430"),l.data}catch(l){const b=(l==null?void 0:l.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0437\u0434\u0430\u043D\u0438\u044F \u0437\u0430\u044F\u0432\u043A\u0438";throw w(b),console.error("Error creating application:",l),T.error(b),l}finally{u(!1)}},[S]),F=r.exports.useCallback(async h=>{try{u(!0),w(null),await Pe(h),await S(),T.success("\u0417\u0430\u044F\u0432\u043A\u0430 \u0443\u0441\u043F\u0435\u0448\u043D\u043E \u0443\u0434\u0430\u043B\u0435\u043D\u0430")}catch(l){const b=(l==null?void 0:l.message)||"\u041E\u0448\u0438\u0431\u043A\u0430 \u0443\u0434\u0430\u043B\u0435\u043D\u0438\u044F \u0437\u0430\u044F\u0432\u043A\u0438";w(b),console.error("Error deleting application:",l),T.error(b)}finally{u(!1)}},[S]);return r.exports.useEffect(()=>{S()},[S,e.language]),{applications:t,loading:a,error:d,loadApplications:S,createApplication:D,deleteApplication:F}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const $e=()=>{const{t:e}=N(["sidebar","site"]),[t,y]=r.exports.useState(!1),{applications:a,loading:u,createApplication:d,deleteApplication:w}=Le(),S=a.some(b=>{var j,E;return b.id_status!==0&&!((j=b.status)!=null&&j.toLowerCase().includes("\u043E\u0442\u043A\u043B\u043E\u043D\u0435\u043D"))&&!((E=b.status)!=null&&E.toLowerCase().includes("\u043E\u0442\u043C\u0435\u043D\u0435\u043D"))}),D=()=>{y(!0)},F=()=>{y(!1)},h=async b=>{try{const j={id_specialty:b.specialtySpecialization,id_bk:b.formOfPayment};await d(j),y(!1)}catch{}},l=async b=>{await w(b)};return p(ve,{children:[p("div",{className:"bg-white p-6 rounded-lg shadow-sm flex justify-between items-center",children:[p("div",{className:"flex gap-6 items-center",children:[m("h1",{className:"text-2xl font-semibold ",children:e("sidebar:sideBar.universities")}),m("a",{className:"text-blue-500 hover:underline",href:Ae.universities,children:e("sidebar:sideBar.allUniversities")})]}),m("div",{className:"flex gap-4",children:m("button",{onClick:D,disabled:S||u,className:`mt-4 py-2 px-4 rounded-lg border-none cursor-pointer transition-colors ${S||u?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-blue-500 text-white hover:bg-[#FF6B00]"}`,children:e(u?"loading":"site:MainPageAllUniversities.Choose")})})]}),m(we,{applications:a,loading:u,onDelete:l}),m(Me,{open:t,onClose:F,onSubmit:h})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};export{$e as UniversityPage,Le as useApplications};
